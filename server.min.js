var express=require("express"),compression=require("compression"),app=express(),port=process.env.PORT||8e3,path=require("path"),mongoose=require("mongoose"),Moment=require("moment");require("mongoose-moment")(mongoose);var passport=require("passport"),flash=require("req-flash"),morgan=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser");app.use(bodyParser.json({limit:"50mb"})),app.use(bodyParser.urlencoded({limit:"50mb",extended:!0}));var session=require("express-session"),cors=require("cors"),unirest=require("unirest");app.use(cors());var favicon=require("serve-favicon");app.use(favicon("./public/images/logo/favicon.ico"));var configDB=require("./config/mydatabase.js");mongoose.connect(configDB.url,{server:{socketOptions:{connectTimeoutMS:1e4}}},function(e){e&&console.log("Mongo DB Error: "+e)}),require("./config/passport")(passport),app.use(require("prerender-node").set("prerenderServiceUrl","https://service.prerender.io/").set("prerenderToken","iVgzdEtOLriSvmSTfKFm").blacklisted("^/claim")),app.use(compression()),app.get("/*",function(e,s,a){(0===e.url.indexOf("/images/")||0===e.url.indexOf("/stylesheets/"))&&(s.setHeader("Cache-Control","public, max-age=2592000"),s.setHeader("Expires",new Date(Date.now()+2592e6).toUTCString())),a()}),app.get("*",function(e,s,a){"https"!=e.get("x-forwarded-proto")?(s.set("x-forwarded-proto","https"),s.redirect("https://"+e.get("host")+e.url)):a()}),app.get("/auth/facebook",passport.authenticate("facebook")),app.get("/auth/facebook/callback",passport.authenticate("facebook",{failureRedirect:"/login"}),function(e,s){s.redirect("/")}),app.use(morgan("dev")),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0})),app.set("views",path.join(__dirname,"views")),app.use(express.static(__dirname+"/views")),app.use(express.static("public")),app.engine("html",require("ejs").renderFile),app.set("view engine","html"),app.use(cookieParser()),app.set("trust proxy",1),app.use(session({secret:"exambazaar 2017",resave:!1,saveUninitialized:!0,cookie:{secure:!0}})),app.use(passport.initialize()),app.use(passport.session()),app.use(flash());var routes=require("./app/routes.js")(app,passport),providers=require("./app/providers.js",providers),targetStudyProviders=require("./app/targetStudyProviders.js",targetStudyProviders),offers=require("./app/offers.js",offers),coupons=require("./app/coupons.js",coupons),reviews=require("./app/reviews.js",reviews),groups=require("./app/groups.js",groups),logourls=require("./app/logourls.js",logourls),masters=require("./app/masters.js",masters),users=require("./app/users.js",users),subscribers=require("./app/subscribers.js",subscribers),notifications=require("./app/notifications.js",notifications),emails=require("./app/emails.js",emails),smss=require("./app/smss.js",smss),otps=require("./app/otps.js",otps),exams=require("./app/exams.js",exams),eligibilitys=require("./app/eligibilitys.js",eligibilitys),streams=require("./app/streams.js",streams),locations=require("./app/locations.js",locations),mediaTags=require("./app/mediaTags.js",mediaTags),cisaveds=require("./app/cisaveds.js",cisaveds),views=require("./app/views.js",views),tofillcis=require("./app/tofillcis.js",tofillcis),rateInstitutes=require("./app/rateInstitutes.js",rateInstitutes),toverifycis=require("./app/toverifycis.js",toverifycis),suggestCoachings=require("./app/suggestCoachings.js",suggestCoachings),addContactInfos=require("./app/addContactInfos.js",addContactInfos),images=require("./app/images.js",images),awsCredentials=require("./app/awsCredentials.js",awsCredentials),sendGridCredentials=require("./app/sendGridCredentials.js",sendGridCredentials);app.use("/api/providers",providers),app.use("/api/targetStudyProviders",targetStudyProviders),app.use("/api/offers",offers),app.use("/api/coupons",coupons),app.use("/api/reviews",reviews),app.use("/api/groups",groups),app.use("/api/logourls",logourls),app.use("/api/masters",masters),app.use("/api/users",users),app.use("/api/subscribers",subscribers),app.use("/api/notifications",notifications),app.use("/api/emails",emails),app.use("/api/smss",smss),app.use("/api/otps",otps),app.use("/api/exams",exams),app.use("/api/eligibilitys",eligibilitys),app.use("/api/streams",streams),app.use("/api/locations",locations),app.use("/api/mediaTags",mediaTags),app.use("/api/cisaveds",cisaveds),app.use("/api/views",views),app.use("/api/tofillcis",tofillcis),app.use("/api/rateInstitutes",rateInstitutes),app.use("/api/toverifycis",toverifycis),app.use("/api/suggestCoachings",suggestCoachings),app.use("/api/addContactInfos",addContactInfos),app.use("/api/images",images),app.use("/api/awsCredentials",awsCredentials),app.use("/api/sendGridCredentials",sendGridCredentials);var allStates=["/","/login","/signup","/review","/search","/allreviews","/rankerswall/:examName/:year","/socialLogin","/reviewcenter/:coachingId","/stream","/stream/:categoryName","/stream/:categoryName/:subCategoryName/","/stream/:categoryName/:subCategoryName/:cityName","/stream/:categoryName/:subCategoryName/:cityName/:coachingId","/group/:categoryName/:subCategoryName/:cityName/:groupName","/oldclaim/:coachingId","/claim/:coachingId","/verifyClaim/:coachingId","/user/:userId/sandbox","/user/:userId/coachingGroup","/user/:userId/suggestCoaching","/master/:masterId/sandbox2/:cityName","/user/:userId/eligibility","/privacy","/about","/calendar","/:instituteId/bulkAddStudents","/:instituteId/bulkAddTeachers","/:instituteId/bulkAddBatches","/:instituteId/instituteCalendar","/:batchId/batchCalendar","/admin/:adminId/main","/user/:userId/sendEmail","/master/:masterId/main","/coaching/database2/:city","/internship","/account","/edit/database1/:coachingId","/coaching/providersWithAreas","/coaching/database1/:city","/master/:masterId/analytics","/master/:masterId/institutes","/master/:masterId/dashboard","/master/:masterId/tofill","/partner/:userId/dashboard","/partner/:userId/offers","/master/:masterId/manageBatchStudents","/master/:masterId/manageInstituteStudents","/master/:masterId/addGlobalSubject","/master/:masterId/invalidusers","/master/:masterId/addGlobalFeeItem","/master/:masterId/mergeUsers","/master/:masterId/invalidParents","/master/:masterId/invalidTeachers","/institute/:instituteId","/institute-batches/:instituteId","/institute-teachers/:instituteId","/institute-students/:instituteId","/student/:studentId/main","/student/:studentId/attendance","/student/:studentId/class","/user/:userId/shortlisted","/user/:userId/viewed","/user/:userId/reviewed","/user/:userId/:reviewId/availoffer","/thankyou","/user/:userId/filled","/user/:userId/assigned","/user/:userId/assignedToVerify","/user/:userId/assignedToAddContactInfo","/user/:userId/assignedToRate","/user/:userId/filledAll","/user/:userId/group","/user/:userId/profile","/user/:userId/checkLogo/:pageNumber/","/student/:studentId/subjects","/:instituteId/addTeacher","/:instituteId/addAdmin","/addStream","/addOffer","/addLocation","/addMediaTag","/addGroup","/addAwsCredential","/addSendGridCredential","/addSubscriber","/addExam","/addEligibility","/master/:masterId/addMaster","/master/:userId/addInstitute","/master/:userId/bulkDisable","/user/:userId/addIntern","/sitemap","/:instituteId/addStudent","/:instituteId/addTransportVehicle","/:instituteId/addBatch","/:instituteId/feeStructure","/verify/:userId/","/chooselogin/:userId/","/subject/:subjectId","/eval/:evalId","/exam/:examId","/batch/:batchId","/batch/:batchId/attendance"];app.use(function(e,s,a){s.header("Access-Control-Allow-Origin","*"),s.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),a()}),allStates.forEach(function(e){app.get(e,function(e,s){s.sendFile(__dirname+"/views/index.html")})}),app.use(function(e,s,a){var r=new Error("Not Found");r.status=404,a(r)});var server=app.listen(port);console.log("The magic happens on port "+port);
//# sourceMappingURL=server.min.js.map